(function(e){function n(e){this.imageCandidates=[],this.srcValue=e.src,this.srcsetValue=e.srcset,this.isValid=!0,this.error="",this._parse(this.srcsetValue),this.isValid||console.error("Error: "+this.error)}function r(e){this.src=e.src,this.w=e.w||Infinity,this.h=e.h||Infinity,this.x=e.x||1}var t=/^[0-9]+$/;n.prototype._parse=function(){var e=this.srcsetValue,t=0,n=[],i,s;while(e!==""){while(e.charAt(0)===" ")e=e.slice(1);t=e.indexOf(" ");if(t!==-1){i=e.slice(0,t);if(i==="")break;e=e.slice(t+1),t=e.indexOf(","),t===-1?(s=e,e=""):(s=e.slice(0,t),e=e.slice(t+1)),n.push({url:i,descriptors:s})}else n.push({url:e,descriptors:""}),e=""}for(var o=0,u=n.length;o<u;o++){var a=n[o],f=this._parseDescriptors(a.descriptors);this._addCandidate(new r({src:a.url,x:f.x,w:f.w,h:f.h}))}this.srcValue&&this._addCandidate(new r({src:this.srcValue}))},n.prototype._addCandidate=function(e){for(var t=0;t<this.imageCandidates.length;t++){var n=this.imageCandidates[t];if(n.x==e.x&&n.w==e.w&&n.h==e.h)return}this.imageCandidates.push(e)},n.prototype._parseDescriptors=function(e){var n=e.split(/\s/),r={};for(var i=0;i<n.length;i++){var s=n[i];if(s.length>0){var o=s[s.length-1],u=s.substring(0,s.length-1),a=parseInt(u,10),f=parseFloat(u);u.match(t)&&o==="w"?r[o]=a:u.match(t)&&o=="h"?r[o]=a:!isNaN(f)&&o=="x"?r[o]=f:(this.error='Invalid srcset descriptor found in "'+s+'".',this.isValid=!1)}}return r},e.SrcsetInfo=n})(window),function(e){function t(){this.w=null,this.h=null,this.x=null}t.prototype.compute=function(){this.w=window.innerWidth,this.h=window.innerHeight,this.x=window.devicePixelRatio},t.prototype.setForTesting=function(e){this.w=e.w,this.h=e.h,this.x=e.x},t.prototype.getBestImage=function(e){var t=e.imageCandidates.slice(0),n=this._getBestCandidateIf(t,function(e,t){return e.w>t.w});this._removeCandidatesIf(t,function(e){return e.w<this.w}.bind(this)),t.length===0&&(t=[n]);var r=this._getBestCandidateIf(t,function(e,t){return e.h>t.h});this._removeCandidatesIf(t,function(e){return e.h<this.h}.bind(this)),t.length===0&&(t=[r]);var i=this._getBestCandidateIf(t,function(e,t){return e.x>t.x});this._removeCandidatesIf(t,function(e){return e.x<this.x}.bind(this)),t.length===0&&(t=[i]);var s=this._getBestCandidateIf(t,function(e,t){return e.w<t.w});this._removeCandidatesIf(t,function(e,t){return e.w>s.w});var o=this._getBestCandidateIf(t,function(e,t){return e.h<t.h});this._removeCandidatesIf(t,function(e,t){return e.h>s.h});var u=this._getBestCandidateIf(t,function(e,t){return e.x<t.x});return this._removeCandidatesIf(t,function(e,t){return e.x>u.x}),t[0]},t.prototype._getBestCandidateIf=function(e,t){var n=e[0];for(var r=0;r<e.length;r++){var i=e[r];t(i,n)&&(n=i)}return n},t.prototype._removeCandidatesIf=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e[n];t(r)&&e.splice(n,1)}return e},t.prototype.getBestImage2=function(e){var t=null,n=e.imageCandidates;for(var r=0;r<n.length;r++){var i=n[r],s=t?t.x:0;if(s<=i.x&&i.x<=this.x){if(t===null){t=i;continue}this.w<=i.w&&i.w<=t.w&&(t=i)}}return t},e.ViewportInfo=t}(window),function(e){function t(){var e=new Image;return"srcset"in e}function n(){if(t())return;var e=new ViewportInfo;e.compute();var n=document.querySelectorAll("img");for(var r=0;r<n.length;r++){var i=n[r],s=i.attributes.srcset;if(s){var o=new SrcsetInfo({src:i.src,srcset:s.textContent}),u=e.getBestImage(o);i.src=u.src,i.style.webkitTransform="scale("+1/u.x+")",i.style.webkitTransformOrigin="0 0"}}}window.addEventListener("DOMContentLoaded",n)}(window);